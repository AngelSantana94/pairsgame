(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const s of t)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function i(t){const s={};return t.integrity&&(s.integrity=t.integrity),t.referrerPolicy&&(s.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?s.credentials="include":t.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function l(t){if(t.ep)return;t.ep=!0;const s=i(t);fetch(t.href,s)}})();class u{constructor(e){this.containerId=document.querySelector(e),this.rows=0,this.cols=0}setupGrid(e,i){this.containerId.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.containerId.style.gridTemplateRows=`repeat(${e}, 1fr)`}clear(){this.containerId.innerHTML=""}addCard(e){this.containerId.appendChild(e)}}class m{constructor(e,i,l){this.id=e,this.imagePath=i,this.gameInstance=l,this.isFlipped=!1,this.element=document.createElement("div"),this.element.classList.add("card"),this.imgElement=document.createElement("img"),this.imgElement.src="./public/img-backside.jpeg",this.imgElement.classList.add("card-img"),this.element.appendChild(this.imgElement),this.element.addEventListener("click",()=>{this.handleFlip()})}handleFlip(){this.isFlipped||this.gameInstance.lockBoard||(this.isFlipped=!0,this.imgElement.src=this.imagePath,this.gameInstance.checkSelection(this))}hide(){this.isFlipped=!1,this.imgElement.src="./public/img-backside.jpeg"}}function n(r){let e=[];for(;r.length>0;){let i=Math.floor(Math.random()*r.length),l=r.splice(i,1)[0];e.unshift(l)}return e}class f{constructor(){this.score=0,this.level=1,this.cardsSelect=[],this.isStarted=!1,this.board=new u("#card-container"),this.firstCard=null,this.secondCard=null,this.lockBoard=!1,this.result=0,this.finalResult=0,this.timeLeft=0,this.timerInterval=null,this.uiTime=document.querySelector("#time"),this.uiResult=document.querySelector("#result"),this.uiFinalResult=document.querySelector("#final-result"),this.header=document.querySelector("#header"),this.uilevel=document.querySelector("#current-level-display"),this.uiboard=document.querySelector("#board"),this.title=document.querySelector("#title"),this.buttonRestart=document.querySelector("#restart"),this.buttonRestart.addEventListener("click",()=>{this.restartGame()}),this.buttonStart=document.querySelector("#start"),this.buttonStart.addEventListener("click",()=>{this.startGame()}),this.buttonExit=document.querySelector("#exit"),this.buttonExit.addEventListener("click",()=>{this.exit()}),this.buttonContinue=document.querySelector("#continue"),this.buttonContinue.addEventListener("click",()=>{this.startGame()});const e={level:this.level,lastDate:new Date().toLocaleDateString()};localStorage.setItem("game_data",JSON.stringify(e));const i=JSON.parse(localStorage.getItem("game_data"));this.level=i?i.level:1}exit(){localStorage.setItem("savedLevel",this.level),this.timerInterval&&clearInterval(this.timerInterval),this.board.clear(),this.level=1,this.isStarted=!1,this.header.style.display="none",this.buttonStart.style.display="block",this.title.style.display="block",this.buttonRestart.style.display="none",this.uiboard.style.display="block",this.buttonExit.style.display="none",this.buttonContinue.style.display="block",console.log("Juego reseteado y de vuelta al menÃº")}startGame(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null),this.level=parseInt(localStorage.getItem("savedLevel"))||1,this.isStarted=!0,this.buttonStart.style.display="none",this.title.style.display="none",this.header.style.display="flex",this.buttonExit.style.display="block",this.buttonRestart.style.display="block",this.buttonContinue.style.display="none",console.log("Comienza el juego"),this.starLevel()}starLevel(){const i={1:{rows:2,cols:2},2:{rows:2,cols:3},3:{rows:3,cols:4}}[this.level];this.result=0,this.finalResult=i.cols*i.rows/2,this.timeLeft=59,this.updateUI(),this.lockBoard=!1,this.uilevel.textContent=this.level,console.log("Comienza el nivel 1"),this.board.clear(),this.board.setupGrid(i.rows,i.cols);let l=i.rows*i.cols/2,t=[];for(let a=1;a<=l;a++)t.push(a);let s=n(t),o=[...s,...s],h=n(o);for(let a of h){let c=`./public/img0${a}.jpeg`,d=new m(a,c,this);this.board.addCard(d.element)}}checkSelection(e){if(this.startTimer(),this.firstCard===null){this.firstCard=e;return}this.secondCard===null&&(this.secondCard=e),this.firstCard.id===this.secondCard.id?(this.result++,console.log("Â¡Pareja encontrada! ðŸŽ‰"),this.updateUI(),this.resetTurn(),this.checkWin()):(console.log("No son iguales... ðŸ˜¢"),this.lockBoard=!0,setTimeout(()=>{this.firstCard.hide(),this.secondCard.hide(),this.resetTurn(),this.lockBoard=!1},700))}resetTurn(){this.firstCard=null,this.secondCard=null}updateUI(){if(this.uiResult&&(this.uiResult.textContent=`${this.result}`),this.uiFinalResult&&(this.uiFinalResult.textContent=`${this.finalResult}`),this.uiTime){let e=Math.floor(this.timeLeft/60),i=this.timeLeft%60,l=e.toString().padStart(2,"0"),t=i.toString().padStart(2,"0");this.uiTime.textContent=`${l}:${t}`,this.timeLeft<=10?this.uiTime.style.color="red":this.uiTime.style.color="black"}}startTimer(){this.timerInterval&&clearInterval(this.timerInterval),this.timerInterval=setInterval(()=>{this.timeLeft--,this.updateUI(),this.timeLeft<=0&&this.gameOver()},700)}checkWin(){this.result===this.finalResult&&(console.log("Â¡Nivel Completado!"),clearInterval(this.timerInterval),setTimeout(()=>{alert(`!Felicidades! Nivel ${this.level} superado.`),this.level++,localStorage.setItem("savedLevel",this.level),console.log(this.level),this.starLevel(),this.level===3&&console.log('"HAS GANADO TODO EL JUEGO"')},500))}gameOver(){clearInterval(this.timerInterval),this.lockBoard=!0,alert("Â¡GAME OVER! Se ha acabado el tiempo. ðŸ•’"),this.starLevel()}restartGame(){console.log("Reiniciando juego desde cero..."),this.timerInterval&&clearInterval(this.timerInterval),this.level=1,localStorage.removeItem("game_data"),localStorage.removeItem("savedLevel"),this.board.clear(),this.uilevel&&(this.uilevel.textContent=this.level),this.startGame()}}console.log("probando enlaces");new f;
